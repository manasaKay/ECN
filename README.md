## [Invariance Matters: Exemplar Memory for Domain Adaptive Person Re-identification CVPR 2019](https://arxiv.org/abs/1904.01990)

![](imgs/framework.png)


### Preparation

#### Requirements: Python=3.6, Pytorch>=1.0.0

1. Install [Pytorch](http://pytorch.org/) and clone this repository or download this repositor


2. Download dataset (Manually perform this! If you prefer automatic please follow 2a)

   - Market-1501 [[BaiduYun]](http://pan.baidu.com/s/1ntIi2Op) [[GoogleDriver]](https://drive.google.com/file/d/0B8-rUzbwVRk0c054eEozWG9COHM/view?usp=sharing) CamStyle (generated by CycleGAN) [[GoogleDriver]](https://drive.google.com/open?id=1klY3nBS2sD4pxcyUbSlhtfTk9ButMNW1) [[BaiduYun]](https://pan.baidu.com/s/1NHv1UfI9bKo1XrDx8g70ow) (password: 6bu4)
   
   - DukeMTMC-reID [[BaiduYun]](https://pan.baidu.com/s/1jS0XM7Var5nQGcbf9xUztw) (password: bhbh) [[GoogleDriver]](https://drive.google.com/open?id=1jjE85dRCMOgRtvJ5RQV9-Afs-2_5dY3O) CamStyle (generated by CycleGAN) [[GoogleDriver]](https://drive.google.com/open?id=1tNc-7C3mpSFa_xOti2PmUVXTEiqmJlUI) [[BaiduYun]](https://pan.baidu.com/s/1NHv1UfI9bKo1XrDx8g70ow) (password: 6bu4)
   
   - Unzip each dataset and corresponding CamStyle under 'ECN/data/'

   Ensure the File structure is as follow:
   
   ```
   ECN/data    
   │
   └───market OR duke
      │   
      └───bounding_box_train
      │   
      └───bounding_box_test
      │   
      └───bounding_box_train_camstyle_cyclegan
      │ 
      └───query
   ```


2a. Download dataset (Automatically perform by running the script)

   - cd into 'data' folder
   
   - Run 'bash make_duke.sh', 'bash make_market.sh' and 'bash make_stargan.sh'
   
   Ensure the File structure is as follow:
   
   ```
   ECN/data    
   │
   └───market OR duke
      │   
      └───bounding_box_train
      │   
      └───bounding_box_test
      │   
      └───bounding_box_train_camstyle_cyclegan
      │   
      └───bounding_box_train_camstyle_stargan
      │ 
      └───query
   ```


### Training and test domain adaptation model for person re-ID

This will produce all the results that are shown in the paper. This generates a log file for every run and the last 5 lines of the log file contains the mAP scores and other results. 

  ```Shell
  # python3 main.py -s duke -t market -cs cyclegan -mmd 1 --lmd 0.3 --lmd_ext 0.33
  # python3 main.py -s duke -t market -cs cyclegan -mmd 1 --lmd 0.3 --lmd_ext 0.33  --evaluate --resume logs/checkpoint.pth.tar
  ```